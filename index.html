<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Translates SEM fitted with OpenMx to Bayesian Networks implemented
    in bnlearn.">
<title>Translate SEM to Bayesian Networks • bnSEM</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Translate SEM to Bayesian Networks">
<meta property="og:description" content="Translates SEM fitted with OpenMx to Bayesian Networks implemented
    in bnlearn.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">bnSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Example.html">Example</a>
    <a class="dropdown-item" href="articles/Factor-Scores.html">Factor-Scores</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><blockquote>
<p><strong>Warning</strong>: bnSEM is very experimental. There are probably already better packages out there that do the same thing. The main objective of bnSEM is to explore similarities between SEM and Bayesian Networks.</p>
</blockquote>
<div class="section level1">
<div class="page-header"><h1 id="bnsem">bnSEM<a class="anchor" aria-label="anchor" href="#bnsem"></a>
</h1></div>
<p>Structural Equation Models (SEM) and Bayesian Networks are closely related. The objective of bnSEM (<strong>B</strong>ayesian <strong>N</strong>etwork <strong>SEM</strong>) is to easily transition from SEM to Bayesian Networks. To this end, <strong>bnSEM</strong> translates SEM fitted with <code>OpenMx</code> (Neale et al., 2016) to Bayesian Networks in <code>bnlearn</code> (Scutari, 2009).</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of bnSEM from <a href="https://github.com/jhorzek/bnSEM/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jhorzek/netSEM"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>We first estimate the SEM with <strong>OpenMx</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/mxsem/" class="external-link">mxsem</a></span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # latent variable definitions</span></span>
<span><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">     dem60 =~ y1 + a*y2 + b*y3 + c*y4</span></span>
<span><span class="st">     dem65 =~ y5 + a*y6 + b*y7 + c*y8</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # regressions</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # residual correlations</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y4 + y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">    y6 ~~ y8</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">mx_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jhorzek.github.io/mxsem/reference/mxsem.html" class="external-link">mxsem</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                  data <span class="op">=</span> <span class="fu">OpenMx</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/OpenMx/man/Bollen_data.html" class="external-link">Bollen</a></span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">OpenMx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">mxTryHard</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next, we translate the model to a Bayesian Network:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/bnSEM/">bnSEM</a></span><span class="op">)</span></span>
<span><span class="va">network</span> <span class="op">&lt;-</span> <span class="fu">bnSEM</span><span class="fu">::</span><span class="fu"><a href="reference/bnSEM.html">bnSEM</a></span><span class="op">(</span>mx_model <span class="op">=</span> <span class="va">mx_model</span><span class="op">)</span></span></code></pre></div>
<p>To get an impression of the network, you can create a plot:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">qgraph</span><span class="op">)</span></span>
<span><span class="fu">qgraph</span><span class="fu">::</span><span class="fu">qgraph</span><span class="op">(</span><span class="va">network</span><span class="op">$</span><span class="va">dag</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/pol_dem_plot.png"></p>
</div>
<div class="section level2">
<h2 id="inference">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<p>With our Bayesian Network, we can now investigate the conditional distribution of variables in our model (see <code><a href="articles/Example.html">vignette("Example", package = "bnSEM")</a></code> for a comparison to rejection sampling)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check conditional distribution</span></span>
<span><span class="co"># probability that dem65 in (1,2) given dem60 &gt; 1:</span></span>
<span><span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpquery</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>,</span>
<span>                 event <span class="op">=</span> <span class="op">(</span><span class="va">dem65</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">dem65</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 evidence <span class="op">=</span> <span class="op">(</span><span class="va">dem60</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3423984</span></span>
<span></span>
<span><span class="co"># Get distribution under this assumption:</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>,</span>
<span>                        node <span class="op">=</span> <span class="st">"dem65"</span>,</span>
<span>                        evidence <span class="op">=</span> <span class="op">(</span><span class="va">dem60</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">dem65</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Now check dem60 &lt; -1</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>,</span>
<span>                        node <span class="op">=</span> <span class="st">"dem65"</span>,</span>
<span>                        evidence <span class="op">=</span> <span class="op">(</span><span class="va">dem60</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">dem65</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-2.png" width="100%"></p>
<p>To check our Bayesian Network, we can also simulate data from the network and refit our SEM to check if the estimates align:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/rbn.html" class="external-link">rbn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>, n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jhorzek.github.io/mxsem/reference/mxsem.html" class="external-link">mxsem</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">sim</span><span class="op">[</span>,<span class="va">mx_model</span><span class="op">$</span><span class="va">manifestVars</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">OpenMx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">mxTryHard</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_sim</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mx_model</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;    ind60→x2    ind60→x3 ind60→dem60 ind60→dem65           a           b </span></span>
<span><span class="co">#&gt;       0.002       0.001       0.008      -0.005      -0.002       0.005 </span></span>
<span><span class="co">#&gt;           c dem60→dem65       y1↔y1       y2↔y2       y3↔y3       y2↔y4 </span></span>
<span><span class="co">#&gt;      -0.003       0.004      -0.001       0.024       0.001       0.041 </span></span>
<span><span class="co">#&gt;       y4↔y4       y2↔y6       y6↔y6       x1↔x1       x2↔x2       x3↔x3 </span></span>
<span><span class="co">#&gt;       0.036       0.001      -0.017       0.000      -0.002      -0.004 </span></span>
<span><span class="co">#&gt;       y1↔y5       y5↔y5       y3↔y7       y7↔y7       y4↔y8       y6↔y8 </span></span>
<span><span class="co">#&gt;      -0.016      -0.016       0.010       0.009       0.006       0.002 </span></span>
<span><span class="co">#&gt;       y8↔y8 ind60↔ind60 dem60↔dem60 dem65↔dem65      one→y1      one→y2 </span></span>
<span><span class="co">#&gt;       0.014       0.003       0.013      -0.014      -0.006      -0.005 </span></span>
<span><span class="co">#&gt;      one→y3      one→y4      one→y6      one→x1      one→x2      one→x3 </span></span>
<span><span class="co">#&gt;       0.010       0.000       0.007      -0.002      -0.004       0.003 </span></span>
<span><span class="co">#&gt;      one→y5      one→y7      one→y8 </span></span>
<span><span class="co">#&gt;       0.005       0.010       0.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="central-challenge">Central Challenge<a class="anchor" aria-label="anchor" href="#central-challenge"></a>
</h2>
<p>When transitioning from SEM to Bayesian Network, a central challenge is the use of covariances as parameters in SEM. To translate those covariances to a model that can be easily used with Bayesian Networks, bnSEM replaces covariances with direct effects of unobserved phantom variables. The approach is explained in more detail, for instance, by Merkle &amp; Rosseel (2015; see p. 8).</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>
<strong>OpenMx</strong>: Neale, M. C., Hunter, M. D., Pritikin, J. N., Zahery, M., Brick, T. R., Kirkpatrick, R. M., … &amp; Boker, S. M. (2016). OpenMx 2.0: Extended structural equation and statistical modeling. Psychometrika, 81, 535-549.</li>
<li>
<strong>bnlearn</strong>; Scutari, M. (2009). Learning Bayesian networks with the bnlearn R package. arXiv preprint arXiv:0908.3817.</li>
<li>Merkle, E. C., &amp; Rosseel, Y. (2015). blavaan: Bayesian structural equation models via parameter expansion. arXiv preprint arXiv:1511.05604.</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bnSEM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jannik H. Orzek <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-3123-2248" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Christian Gische <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-7372-2894" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jannik H. Orzek, Christian Gische.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
