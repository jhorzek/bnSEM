<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Conditional-and-Interventional-Distribution • bnSEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conditional-and-Interventional-Distribution">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bnSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Conditional-and-Interventional-Distribution.html">Conditional-and-Interventional-Distribution</a></li>
    <li><a class="dropdown-item" href="../articles/Factor-Scores.html">Factor-Scores</a></li>
    <li><a class="dropdown-item" href="../articles/Inference-Example.html">Inference-Example</a></li>
    <li><a class="dropdown-item" href="../articles/Translating-SEM-to-bnlearn.html">Translating-SEM-to-bnlearn</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Conditional-and-Interventional-Distribution</h1>
            
      

      <div class="d-none name"><code>Conditional-and-Interventional-Distribution.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/bnSEM/">bnSEM</a></span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Warning: The following is very experimental and could be very wrong.
This is just a first draft at getting interventional distributions from
SEM by leveraging Bayesian networks. A proper discussion of
observational and interventional distribution can be found in <span class="citation">Gische and Voelkle (2022)</span>.</p>
</blockquote>
<p>Bayesian Networks allow investigating the conditional and
interventional distribution of network nodes.</p>
<p>The central difference between conditional and interventional
distribution can be explained with the classical sprinkler-rain model
<span class="citation">(see e.g., Murphy 2012, 944)</span>. However,
because it is a German tradition to explain everything with cars, we
will use a variation thereof. Let’s assume we are interested in the
relations between Rain (R), hydroplaning (H) and windscreen wipers (W).
Rain causes both hydroplaning and the activation of windscreen
wipers:</p>
<p><img src="Conditional-and-Interventional-Distribution_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Now, knowing that the windscreen wipers are activated, it is a fairly
likely that it rains and therefore the likelihood of hydroplaning is
also higher. This is expressed by the <em>conditional distribution</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mo>=</mo><mtext mathvariant="normal">TRUE</mtext><mo stretchy="false" form="prefix">|</mo><mi>W</mi><mo>=</mo><mtext mathvariant="normal">TRUE</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(R = \text{TRUE} | W  = \text{TRUE})</annotation></semantics></math>.</p>
<p>Of course, activating or deactivating the windscreen wipers (i.e.,
intervening on the windscreen wipers) will not cause the weather to
change, nor will it cause hydroplaning. This is expressed in the
<em>interventional distribution</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>R</mi><mo>=</mo><mtext mathvariant="normal">TRUE</mtext><mo stretchy="false" form="prefix">|</mo><mi>d</mi><mi>o</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>W</mi><mo>=</mo><mtext mathvariant="normal">TRUE</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(R = \text{TRUE} | do(W = \text{TRUE}))</annotation></semantics></math>.</p>
<div class="section level4">
<h4 id="specity-model-in-bnlearn">Specity Model in bnlearn<a class="anchor" aria-label="anchor" href="#specity-model-in-bnlearn"></a>
</h4>
<p>Let’s investigate the model above with bnlearn <span class="citation">(Scutari 2009)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the following code is adapted from https://www.bnlearn.com/examples/custom-fitted/</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.bnlearn.com/" class="external-link">bnlearn</a></span><span class="op">)</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>, </span>
<span>            ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>, <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.2</span>,</span>
<span>                     <span class="fl">.1</span>, <span class="fl">.8</span><span class="op">)</span>, </span>
<span>            nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>, <span class="st">"FALSE"</span><span class="op">)</span>,</span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>, <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">.05</span>,</span>
<span>                     <span class="fl">.2</span>, <span class="fl">.95</span><span class="op">)</span>, </span>
<span>            nrow <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>, <span class="st">"FALSE"</span><span class="op">)</span>,</span>
<span>                            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>, <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">net</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/modelstring.html" class="external-link">model2network</a></span><span class="op">(</span><span class="st">"[R][W|R][H|R]"</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/bn.fit.html" class="external-link">custom.fit</a></span><span class="op">(</span><span class="va">net</span>, dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R</span>, </span>
<span>                                  W <span class="op">=</span> <span class="va">W</span>, </span>
<span>                                  H <span class="op">=</span> <span class="va">H</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Bayesian network parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node H (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;        R</span></span>
<span><span class="co">#&gt; H       TRUE FALSE</span></span>
<span><span class="co">#&gt;   TRUE  0.80  0.05</span></span>
<span><span class="co">#&gt;   FALSE 0.20  0.95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node R (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  TRUE FALSE </span></span>
<span><span class="co">#&gt;   0.2   0.8 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node W (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;        R</span></span>
<span><span class="co">#&gt; W       TRUE FALSE</span></span>
<span><span class="co">#&gt;   TRUE   0.9   0.2</span></span>
<span><span class="co">#&gt;   FALSE  0.1   0.8</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="conditional-distribution">Conditional Distribution<a class="anchor" aria-label="anchor" href="#conditional-distribution"></a>
</h4>
<p>Let’s first investigate the conditional probability of hydroplaning
given that the windscreen<br>
wipers are on. We can do so with the <code>cpquery</code> function (see
<code><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">?bnlearn::cpquery</a></code>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpquery</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">fit</span>, </span>
<span>        event <span class="op">=</span> <span class="op">(</span><span class="va">H</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, </span>
<span>        evidence <span class="op">=</span> <span class="op">(</span><span class="va">W</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>,</span>
<span>        n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4434798</span></span></code></pre></div>
<p>Now, let’s investigate the conditional probability of hydroplaning
given that the windscreen<br>
wipers are off:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpquery</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">fit</span>, </span>
<span>        event <span class="op">=</span> <span class="op">(</span><span class="va">H</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, </span>
<span>        evidence <span class="op">=</span> <span class="op">(</span><span class="va">W</span> <span class="op">==</span> <span class="st">"FALSE"</span><span class="op">)</span>,</span>
<span>        n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07277151</span></span></code></pre></div>
<p>We can see that knowing the status of the windscreen wiper allows us
to also make a better guess of whether to expect hydroplaning.</p>
</div>
<div class="section level4">
<h4 id="interventional-distribution">Interventional Distribution<a class="anchor" aria-label="anchor" href="#interventional-distribution"></a>
</h4>
<p>For the interventional distribution we have to look at the so-called
mutilated network (see <code><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">?bnlearn::mutilated</a></code>). The basic idea
here is that intervening on the windscreen wiper will cut any connection
of the windscreen wiper and its parent nodes (here rain). First, let’s
look at the probability of hydroplaning given we turn the windscreen
wipers on. In the following, note how windscreen wipers W is no longer
affected by rain R:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">mutilated</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit</span>,</span>
<span>                 evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"W"</span> <span class="op">=</span> <span class="st">"TRUE"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mut</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Bayesian network parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node H (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;        R</span></span>
<span><span class="co">#&gt; H       TRUE FALSE</span></span>
<span><span class="co">#&gt;   TRUE  0.80  0.05</span></span>
<span><span class="co">#&gt;   FALSE 0.20  0.95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node R (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  TRUE FALSE </span></span>
<span><span class="co">#&gt;   0.2   0.8 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node W (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;   TRUE FALSE </span></span>
<span><span class="co">#&gt;     1     0</span></span></code></pre></div>
<p>The probability of hydroplaning given we turn the windscreen wipers
on is given by:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpquery</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">mut</span>, </span>
<span>        event <span class="op">=</span> <span class="op">(</span><span class="va">H</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, </span>
<span>        evidence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.20054</span></span></code></pre></div>
<p>Now, let’s look at the probability of hydroplaning given we turn the
windscreen wipers off:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">mutilated</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fit</span>,</span>
<span>                 evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"W"</span> <span class="op">=</span> <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mut</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Bayesian network parameters</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node H (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;        R</span></span>
<span><span class="co">#&gt; H       TRUE FALSE</span></span>
<span><span class="co">#&gt;   TRUE  0.80  0.05</span></span>
<span><span class="co">#&gt;   FALSE 0.20  0.95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node R (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  TRUE FALSE </span></span>
<span><span class="co">#&gt;   0.2   0.8 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parameters of node W (multinomial distribution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional probability table:</span></span>
<span><span class="co">#&gt;   TRUE FALSE </span></span>
<span><span class="co">#&gt;     0     1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpquery</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">mut</span>, </span>
<span>        event <span class="op">=</span> <span class="op">(</span><span class="va">H</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, </span>
<span>        evidence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        n <span class="op">=</span> <span class="fl">100000</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.20083</span></span></code></pre></div>
<p>Note how the probability of hydroplaning is no longer predicted by
the windscreen wiper status. This is because we cut the link to the
parent node - rain R - by intervening on the windscreen wiper.</p>
</div>
<div class="section level3">
<h3 id="structural-equation-models">Structural Equation Models<a class="anchor" aria-label="anchor" href="#structural-equation-models"></a>
</h3>
<p>The difference between conditional and interventional distribution in
SEM is discussed in detail by <span class="citation">Gische and Voelkle
(2022)</span>.</p>
<p>To apply the ideas outlined above to an SEM, we will use a the
Political Democracy model fitted with OpenMx <span class="citation">(Neale et al. 2016)</span>. The model is given by:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhorzek.github.io/mxsem/" class="external-link">mxsem</a></span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">  # latent variable definitions</span></span>
<span><span class="st">     ind60 =~ x1 + x2 + x3</span></span>
<span><span class="st">     dem60 =~ y1 + a*y2 + b*y3 + c*y4</span></span>
<span><span class="st">     dem65 =~ y5 + a*y6 + b*y7 + c*y8</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # regressions</span></span>
<span><span class="st">    dem60 ~ ind60</span></span>
<span><span class="st">    dem65 ~ ind60 + dem60</span></span>
<span><span class="st"></span></span>
<span><span class="st">  # residual correlations</span></span>
<span><span class="st">    y1 ~~ y5</span></span>
<span><span class="st">    y2 ~~ y4 + y6</span></span>
<span><span class="st">    y3 ~~ y7</span></span>
<span><span class="st">    y4 ~~ y8</span></span>
<span><span class="st">    y6 ~~ y8</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">mx_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jhorzek.github.io/mxsem/reference/mxsem.html" class="external-link">mxsem</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                  data <span class="op">=</span> <span class="fu">OpenMx</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/OpenMx/man/Bollen_data.html" class="external-link">Bollen</a></span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">OpenMx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/OpenMx/man/mxTryHard.html" class="external-link">mxTryHard</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>First, we translate the model to a Bayesian network:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">network</span> <span class="op">&lt;-</span> <span class="fu">bnSEM</span><span class="fu">::</span><span class="fu"><a href="../reference/bnSEM.html">bnSEM</a></span><span class="op">(</span>mx_model <span class="op">=</span> <span class="va">mx_model</span><span class="op">)</span></span></code></pre></div>
<p>Next, we want to investigate the conditional distribution of dem65
given y6 = 1. Here, we will use the cpdist function to generate
samples.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond_dist</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>, </span>
<span>                             nodes <span class="op">=</span> <span class="st">"dem65"</span>, </span>
<span>                             evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"y6"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>                             method <span class="op">=</span> <span class="st">"lw"</span><span class="op">)</span></span>
<span><span class="co"># Using likelihood weighting, we have to take the weights into account when</span></span>
<span><span class="co"># computing the expected value and the variance</span></span>
<span><span class="co"># mean</span></span>
<span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cond_dist</span><span class="op">$</span><span class="va">dem65</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.9471441</span></span>
<span><span class="co"># variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">cond_dist</span><span class="op">$</span><span class="va">dem65</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.990131</span></span></code></pre></div>
<p>To get the interventional distribution, we can again use the
mutilated network:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">mutilated</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>, </span>
<span>                 evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"y6"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">inter_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">mut</span>,</span>
<span>                     nodes <span class="op">=</span> <span class="st">"dem65"</span>,</span>
<span>                     evidence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"lw"</span><span class="op">)</span></span>
<span><span class="co"># mean</span></span>
<span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">inter_dist</span><span class="op">$</span><span class="va">dem65</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.01412657</span></span>
<span><span class="co"># variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">inter_dist</span><span class="op">$</span><span class="va">dem65</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.554579</span></span></code></pre></div>
<p>Note that this is identical to the expected value of dem65 (0; with
some numerical imprecision due to sampling).</p>
<p>Let’s look at another example. To this end, we will first check the
mean and variance of x1 in our network.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>, </span>
<span>                        nodes <span class="op">=</span> <span class="st">"x1"</span>, </span>
<span>                        evidence <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                        method <span class="op">=</span> <span class="st">"lw"</span><span class="op">)</span></span>
<span><span class="co"># mean</span></span>
<span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.062848</span></span>
<span><span class="co"># variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dist</span>, <span class="st">"weights"</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">dist</span><span class="op">$</span><span class="va">x1</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.5276746</span></span></code></pre></div>
<p>Now, let’s check the conditional mean and variance of x1 are given
that dem60 = 3</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cond_dist</span> <span class="op">&lt;-</span> <span class="fu">bnlearn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>, </span>
<span>                             nodes <span class="op">=</span> <span class="st">"x1"</span>, </span>
<span>                             evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"dem60"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, </span>
<span>                             method <span class="op">=</span> <span class="st">"lw"</span><span class="op">)</span></span>
<span><span class="co"># mean</span></span>
<span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cond_dist</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.462163</span></span>
<span><span class="co"># variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">cond_dist</span><span class="op">$</span><span class="va">x1</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cond_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4428409</span></span></code></pre></div>
<p>Note how knowledge about dem60 provides us with information about the
indicator x1 of ind60.</p>
<p>When intervening on dem60, in contrast, we don’t change our
expectation for x1:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">mutilated</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">network</span><span class="op">$</span><span class="va">bayes_net</span>, </span>
<span>                 evidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"dem60"</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">inter_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bnlearn/man/cpquery.html" class="external-link">cpdist</a></span><span class="op">(</span>fitted <span class="op">=</span> <span class="va">mut</span>,</span>
<span>                     nodes <span class="op">=</span> <span class="st">"x1"</span>,</span>
<span>                     evidence <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                     method <span class="op">=</span> <span class="st">"lw"</span><span class="op">)</span></span>
<span><span class="co"># mean</span></span>
<span><span class="op">(</span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">inter_dist</span><span class="op">$</span><span class="va">x1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.052059</span></span>
<span><span class="co"># variance</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">inter_dist</span><span class="op">$</span><span class="va">x1</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">inter_dist</span>, <span class="st">"weights"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.529606</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gische2022beyond" class="csl-entry">
Gische, Christian, and Manuel C Voelkle. 2022. <span>“Beyond the Mean: A
Flexible Framework for Studying Causal Effects Using Linear
Models.”</span> <em>Psychometrika</em> 87 (3): 868–901.
</div>
<div id="ref-murphy2012machine" class="csl-entry">
Murphy, Kevin P. 2012. <em>Machine Learning: A Probabilistic
Perspective</em>. MIT press.
</div>
<div id="ref-neale2016openmx" class="csl-entry">
Neale, Michael C, Michael D Hunter, Joshua N Pritikin, Mahsa Zahery,
Timothy R Brick, Robert M Kirkpatrick, Ryne Estabrook, Timothy C Bates,
Hermine H Maes, and Steven M Boker. 2016. <span>“OpenMx 2.0: Extended
Structural Equation and Statistical Modeling.”</span>
<em>Psychometrika</em> 81: 535–49.
</div>
<div id="ref-scutari2009learning" class="csl-entry">
Scutari, Marco. 2009. <span>“Learning Bayesian Networks with the Bnlearn
r Package.”</span> <em>arXiv Preprint arXiv:0908.3817</em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jannik H. Orzek, Christian Gische.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
